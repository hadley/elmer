<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Call LLM APIs from R • elmer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Call LLM APIs from R">
<meta name="description" content="A consistent interface for calling LLM APIs. Includes support for streaming.">
<meta property="og:description" content="A consistent interface for calling LLM APIs. Includes support for streaming.">
<meta property="og:image" content="https://elmer.tidyverse.org/logo.png">
<script defer data-domain="elmer.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">elmer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/elmer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/prompt-design.html">Prompt design</a></li>
    <li><a class="dropdown-item" href="articles/streaming-async.html">Streaming and async APIs</a></li>
    <li><a class="dropdown-item" href="articles/structured-data.html">Structured data</a></li>
    <li><a class="dropdown-item" href="articles/tool-calling.html">Tool/function calling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/elmer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="elmer-">elmer 
<a class="anchor" aria-label="anchor" href="#elmer-"></a>
</h1>
</div>
<!-- badges: start -->

<p>elmer makes it easy to use large language models (LLM) from R. It supports a wide variety of LLM providers and implements a rich set of features including streaming outputs, tool/function calling, structured data extraction, and more.</p>
<p>(Looking for something similar to elmer for python? Check out <a href="https://github.com/cpsievert/chatlas" class="external-link">chatlas</a>!)</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of elmer from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"tidyverse/elmer"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="providers">Providers<a class="anchor" aria-label="anchor" href="#providers"></a>
</h2>
<p>elmer supports a wide variety of model providers:</p>
<ul>
<li>Anthropic’s Claude: <code><a href="reference/chat_claude.html">chat_claude()</a></code>.</li>
<li>AWS Bedrock: <code><a href="reference/chat_bedrock.html">chat_bedrock()</a></code>.</li>
<li>Azure OpenAI: <code><a href="reference/chat_azure.html">chat_azure()</a></code>.</li>
<li>Databricks: <code><a href="reference/chat_databricks.html">chat_databricks()</a></code>.</li>
<li>GitHub model marketplace: <code><a href="reference/chat_github.html">chat_github()</a></code>.</li>
<li>Google Gemini: <code><a href="reference/chat_gemini.html">chat_gemini()</a></code>.</li>
<li>Groq: <code><a href="reference/chat_groq.html">chat_groq()</a></code>.</li>
<li>Ollama: <code><a href="reference/chat_ollama.html">chat_ollama()</a></code>.</li>
<li>OpenAI: <code><a href="reference/chat_openai.html">chat_openai()</a></code>.</li>
<li>perplexity.ai: <code><a href="reference/chat_perplexity.html">chat_perplexity()</a></code>.</li>
<li>Snowflake Cortex: <code><a href="reference/chat_cortex.html">chat_cortex()</a></code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-choice">Model choice<a class="anchor" aria-label="anchor" href="#model-choice"></a>
</h2>
<p>If you’re using elmer inside your organisation, you’ll be limited to what your IT department allows, which is likely to be one provided by a big cloud provider, e.g. <code><a href="reference/chat_azure.html">chat_azure()</a></code>, <code><a href="reference/chat_bedrock.html">chat_bedrock()</a></code>, <code><a href="reference/chat_databricks.html">chat_databricks()</a></code>, or <code>chat_snowflake()</code>. If you’re using elmer for your own exploration, you’ll have a lot more freedom, so we have a few recommendations to help you get started:</p>
<ul>
<li><p><code><a href="reference/chat_openai.html">chat_openai()</a></code> or <code><a href="reference/chat_claude.html">chat_claude()</a></code> are good places to start. <code><a href="reference/chat_openai.html">chat_openai()</a></code> defaults to <strong>GPT-4o</strong>, but you can use <code>model = "gpt-4o-mini"</code> for a cheaper, lower-quality model, or <code>model = "o1-mini"</code> for more complex reasoning. <code><a href="reference/chat_claude.html">chat_claude()</a></code> is also good; it defaults to <strong>Claude 3.5 Sonnet</strong>, which we have found to be particularly good at writing code.</p></li>
<li><p><code><a href="reference/chat_gemini.html">chat_gemini()</a></code> is great for large prompts because it has a much larger context window than other models. It allows up to 1 million tokens, compared to Claude 3.5 Sonnet’s 200k and GPT-4o’s 128k.</p></li>
<li><p><code><a href="reference/chat_ollama.html">chat_ollama()</a></code>, which uses <a href="https://ollama.com" class="external-link">Ollama</a>, allows you to run models on your own computer. While the biggest models you can run locally aren’t as good as the state of the art hosted models, they don’t share your data and are effectively free.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="using-elmer">Using elmer<a class="anchor" aria-label="anchor" href="#using-elmer"></a>
</h2>
<p>You can work with elmer in several different ways, depending on whether you are working interactively or programmatically. They all start with creating a new chat object:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://elmer.tidyverse.org">elmer</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/chat_openai.html">chat_openai</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>,</span>
<span>  system_prompt <span class="op">=</span> <span class="st">"You are a friendly but terse assistant."</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>Chat objects are stateful <a href="https://r6.r-lib.org" class="external-link">R6 objects</a>: they retain the context of the conversation, so each new query builds on the previous ones. You call their methods with <code>$</code>.</p>
<div class="section level3">
<h3 id="interactive-chat-console">Interactive chat console<a class="anchor" aria-label="anchor" href="#interactive-chat-console"></a>
</h3>
<p>The most interactive and least programmatic way of using elmer is to chat directly in your R console or browser with <code>live_console(chat)</code> or <code><a href="reference/live_console.html">live_browser()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/live_console.html">live_console</a></span><span class="op">(</span><span class="va">chat</span><span class="op">)</span></span>
<span><span class="co">#&gt; ╔════════════════════════════════════════════════════════╗</span></span>
<span><span class="co">#&gt; ║  Entering chat console. Use """ for multi-line input.  ║</span></span>
<span><span class="co">#&gt; ║  Press Ctrl+C to quit.                                 ║</span></span>
<span><span class="co">#&gt; ╚════════════════════════════════════════════════════════╝</span></span>
<span><span class="co">#&gt; &gt;&gt;&gt; Who were the original creators of R?</span></span>
<span><span class="co">#&gt; R was originally created by Ross Ihaka and Robert Gentleman at the University of</span></span>
<span><span class="co">#&gt; Auckland, New Zealand.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; &gt;&gt;&gt; When was that?</span></span>
<span><span class="co">#&gt; R was initially released in 1995. Development began a few years prior to that,</span></span>
<span><span class="co">#&gt; in the early 1990s.</span></span></code></pre></div>
<p>Keep in mind that the chat object retains state, so when you enter the chat console, any previous interactions with that chat object are still part of the conversation, and any interactions you have in the chat console will persist after you exit back to the R prompt. This is true regardless of which chat function you use.</p>
</div>
<div class="section level3">
<h3 id="interactive-method-call">Interactive method call<a class="anchor" aria-label="anchor" href="#interactive-method-call"></a>
</h3>
<p>The second most interactive way to chat is to call the <code>chat()</code> method:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chat</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="st">"What preceding languages most influenced R?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; R was primarily influenced by the S programming language, particularly S-PLUS.</span></span>
<span><span class="co">#&gt; Other languages that had an impact include Scheme and various data analysis</span></span>
<span><span class="co">#&gt; languages.</span></span></code></pre></div>
<p>If you initialize the chat object in the global environment, the <code>chat</code> method will stream the response to the console. When the entire response is received, it’s also (invisibly) returned as a character vector. This is useful when you want to see the response as it arrives, but you don’t want to enter the chat console.</p>
<p>If you want to ask a question about an image, you can pass one or more additional input arguments using <code><a href="reference/content_image_url.html">content_image_file()</a></code> and/or <code><a href="reference/content_image_url.html">content_image_url()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chat</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="reference/content_image_url.html">content_image_url</a></span><span class="op">(</span><span class="st">"https://www.r-project.org/Rlogo.png"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Can you explain this logo?"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The logo of R features a stylized letter "R" in blue, enclosed in an oval</span></span>
<span><span class="co">#&gt; shape that resembles the letter "O," signifying the programming language's</span></span>
<span><span class="co">#&gt; name. The design conveys a modern and professional look, reflecting its use</span></span>
<span><span class="co">#&gt; in statistical computing and data analysis. The blue color often represents</span></span>
<span><span class="co">#&gt; trust and reliability, which aligns with R's role in data science.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="programmatic-chat">Programmatic chat<a class="anchor" aria-label="anchor" href="#programmatic-chat"></a>
</h3>
<p>The most programmatic way to chat is to create the chat object inside a function. By doing so, live streaming is automatically suppressed and <code>$chat()</code> returns the result as a string:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/chat_openai.html">chat_openai</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>,</span>
<span>    system_prompt <span class="op">=</span> <span class="st">"You are a friendly but terse assistant."</span>,</span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">chat</span><span class="op">$</span><span class="fu">chat</span><span class="op">(</span><span class="st">"Is R a functional programming language?"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_function</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Yes, R supports functional programming concepts. It allows functions to</span></span>
<span><span class="co">#&gt; be first-class objects, supports higher-order functions, and encourages the</span></span>
<span><span class="co">#&gt; use of functions as core components of code. However, it also supports</span></span>
<span><span class="co">#&gt; procedural and object-oriented programming styles."</span></span></code></pre></div>
<p>If needed, you can manually control this behaviour with the <code>echo</code> argument. This is useful for programming with elmer when the result is either not intended for human consumption or when you want to process the response before displaying it.</p>
</div>
</div>
<div class="section level2">
<h2 id="learning-more">Learning more<a class="anchor" aria-label="anchor" href="#learning-more"></a>
</h2>
<p>elmer comes with a bunch of vignettes to help you learn more:</p>
<ul>
<li>Learn key vocabulary and see example use cases in <code><a href="articles/elmer.html">vignette("elmer")</a></code>.</li>
<li>Learn how to design your prompt in <code><a href="articles/prompt-design.html">vignette("prompt-design")</a></code>.</li>
<li>Learn about tool/function calling in <code><a href="articles/tool-calling.html">vignette("tool-calling")</a></code>.</li>
<li>Learn how to extract structured data in <code><a href="articles/structured-data.html">vignette("structured-data")</a></code>.</li>
<li>Learn about streaming and async APIs in <code><a href="articles/streaming-async.html">vignette("streaming-async")</a></code>.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tidyverse/elmer/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tidyverse/elmer/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing elmer</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://hadley.nz" class="external-link">Hadley Wickham</a> <br><small class="roles"> Author, maintainer </small>  </li>
<li>Joe Cheng <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a> <br><small class="roles"> Copyright holder, funder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/tidyverse/elmer/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tidyverse/elmer/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, Joe Cheng, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
